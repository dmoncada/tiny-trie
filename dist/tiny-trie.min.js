!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.TinyTrie=t():e.TinyTrie=t()}(this,function(){return function(e){function t(n){if(r[n])return r[n].exports;var i=r[n]={exports:{},id:n,loaded:!1};return e[n].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var r={};return t.m=e,t.c=r,t.p="",t(0)}([function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e){var t=new a["default"];return e.forEach(function(e){return t.insert(e)}),t}function u(e){return i(e).freeze()}Object.defineProperty(t,"__esModule",{value:!0}),t.Trie=void 0;var o=r(3);Object.defineProperty(t,"Trie",{enumerable:!0,get:function(){return o["default"]}}),t.createSync=i,t.createFrozenSync=u;var a=n(o)},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=t.BASE64_INT_TO_CHAR="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split("");t.BASE64_CHAR_TO_INT=r.reduce(function(e,t,r){return e[t]=r,e},{})},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.TERMINAL="\x00",t.TERMINUS=Object.create(null),t.VERSION=0,t.HEADER_WIDTH_FIELD=10,t.VERSION_FIELD=10,t.OFFSET_SIGN_FIELD=1,t.OFFSET_VAL_FIELD=21,t.CHAR_WIDTH_FIELD=8,t.POINTER_WIDTH_FIELD=8},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function u(e){return e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();Object.defineProperty(t,"__esModule",{value:!0});var f=r(4),s=n(f),c=r(5),l=n(c),h=r(2),_=function(){function e(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];o(this,e),this.root=t,this.frozen=!1}return a(e,[{key:"insert",value:function(e){if(this.frozen)throw new SyntaxError("Can't insert into frozen Trie");var t=e.split("").reduce(function(e,t){if(t===h.TERMINAL)throw new TypeError("Illegal string character "+h.TERMINAL);var r=e.hasOwnProperty(t)?e[t]:e[t]={};return r},this.root);return t[h.TERMINAL]=h.TERMINUS,this}},{key:"test",value:function(e){var t=this,r=arguments.length<=1||void 0===arguments[1]?{wildcard:null,prefix:!1}:arguments[1],n=r.wildcard,i=r.prefix;if(!n){var o=function(){var r=t.root,n=e.split("").every(function(e){return r=r[e]});return{v:!!n&&(i||r.hasOwnProperty(h.TERMINAL))}}();if("object"===("undefined"==typeof o?"undefined":u(o)))return o.v}return!!this.search(e,{wildcard:n,prefix:i,first:!0})}},{key:"search",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?{wildcard:null,prefix:!1,first:!1}:arguments[1],r=t.wildcard,n=t.prefix,i=t.first;if(r&&1!==r.length)throw new Error("Wildcard length must be 1; got "+r.length);for(var u=[],o=[{data:this.root,depth:0,memo:""}],a=e.length;o.length;){var f=o.shift();if(f.depth>=a){if(f.data.hasOwnProperty(h.TERMINAL)){if(i)return f.memo;u.push(f.memo)}if(!n)continue}var s=n&&f.depth>=a,c=e[f.depth];c===r||s?Object.keys(f.data).forEach(function(e){e!==h.TERMINAL&&o.push({data:f.data[e],depth:f.depth+1,memo:f.memo+e})}):f.data.hasOwnProperty(c)&&o.push({data:f.data[c],depth:f.depth+1,memo:f.memo+c})}return i?null:u}},{key:"clone",value:function(){return new e(this.toJSON())}},{key:"freeze",value:function(){if(this.frozen)return this;for(var e={},t=this.root,r=[],n=[t];n.length;)t=n.pop(),Object.keys(t).forEach(function(e){if("_"!==e[1]){var i=t[e];r.push({current:i,"char":e,parent:t}),n.push(i)}});for(var i=function(){var t=r.pop(),n=t["char"],i=t.parent,u=t.current;if(e.hasOwnProperty(n)){var o=e[n],a=o.find(function(e){var t=Object.keys(e),r=Object.keys(u);return t.length===r.length&&t.every(function(t){return e[t]===u[t]})});a?i[n]=a:o.push(u)}else e[n]=[u]};r.length;)i();return this.frozen=!0,this}},{key:"encode",value:function(){for(var e=[],t=[this.root],r=new Set,n=Date.now(),u=1/0,o=-(1/0),a=function(){var i=t.shift(),a=Object.keys(i).filter(function(e){return"_"!==e[1]}),f=a.length;i.__visited__=n;var s=i.__idx__=e.length;i.__parents__&&i.__parents__.forEach(function(e){var t=e.offset=s-e.idx;u>t&&(u=t),t>o&&(o=t)}),a.forEach(function(a,s){var c=i[a],l=e.length,h=s===f-1,_={"char":a,idx:l,offset:null,last:h};if(c.__visited__===n){var d=c.__idx__,p=_.offset=d-l;u>p&&(u=p),p>o&&(o=p)}else c.__willVisit__===n?c.__parents__.push(_):(c.__willVisit__=n,c.__parents__=[_]),t.push(c);e.push(_),r.add(a)})};t.length;)a();var f=Array.from(r).filter(function(e){return e!==h.TERMINAL}),c=f.reduce(function(e,t,r){return e[t]=r+1,e},i({},h.TERMINAL,0)),_=(0,s["default"])(f.length)+1,d=o-u,p=(0,s["default"])(d)+1,v=new l["default"];e.forEach(function(e){var t=e["char"],r=e.offset,n=e.last;v.write(c[t],_),v.write(r-u,p),v.write(+n,1)}),v.flush();var E=new l["default"],y=f.join(""),I=Math.ceil((h.HEADER_WIDTH_FIELD+h.VERSION_FIELD+h.OFFSET_SIGN_FIELD+h.OFFSET_VAL_FIELD+h.CHAR_WIDTH_FIELD+h.POINTER_WIDTH_FIELD)/6)+y.length,g=+(0>u);return E.write(I,h.HEADER_WIDTH_FIELD),E.write(h.VERSION,h.VERSION_FIELD),E.write(g,h.OFFSET_SIGN_FIELD),E.write(g?-u:u,h.OFFSET_VAL_FIELD),E.write(_,h.CHAR_WIDTH_FIELD),E.write(p,h.POINTER_WIDTH_FIELD),E.flush(),""+E.getData()+y+v.getData()}},{key:"toJSON",value:function(){var e=JSON.stringify(this.root,function(e,t){return"_"===e[1]?void 0:t});return JSON.parse(e)}}]),e}();t["default"]=_},function(e,t){"use strict";function r(e){for(var t=0;e>>=1;)t++;return t}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=r},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();Object.defineProperty(t,"__esModule",{value:!0});var o=r(4),a=n(o),f=r(1),s=function(){function e(){i(this,e),this.buffer=0,this.pointer=0,this.data=""}return u(e,[{key:"write",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?null:arguments[1],r=this.buffer,n=t||(0,a["default"])(e)+1;if(t&&e>=1<<t)throw new Error("Can't write "+e+" in only "+t+" bits");this.buffer=r<<n|e,this.pointer+=n,this._digest()}},{key:"flush",value:function(){for(var e=this.buffer,t=this.pointer;t&&6>t;)e<<=1,t+=1;this.pointer=t,this.buffer=e,this._digest()}},{key:"getData",value:function(){return this.flush(),this.data}},{key:"_digest",value:function(){for(var e=this.buffer,t=this.pointer,r="";t>=6;){var n=t-6,i=e>>n;e^=i<<n,t=n,r+=f.BASE64_INT_TO_CHAR[i]}this.pointer=t,this.buffer=e,this.data+=r}}]),e}();t["default"]=s}])});