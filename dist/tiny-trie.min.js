!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.TinyTrie=t():e.TinyTrie=t()}(this,function(){return function(e){function t(n){if(r[n])return r[n].exports;var i=r[n]={exports:{},id:n,loaded:!1};return e[n].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var r={};return t.m=e,t.c=r,t.p="",t(0)}([function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e){var t=new f["default"];return e.forEach(function(e){return t.insert(e)}),t}function u(e){return i(e).freeze()}Object.defineProperty(t,"__esModule",{value:!0}),t.Trie=void 0;var o=r(3);Object.defineProperty(t,"Trie",{enumerable:!0,get:function(){return o["default"]}}),t.createSync=i,t.createFrozenSync=u;var f=n(o)},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=t.BASE64_INT_TO_CHAR="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split("");t.BASE64_CHAR_TO_INT=r.reduce(function(e,t,r){return e[t]=r,e},{})},function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.TERMINAL="\x00",t.TERMINUS=Object.create(null),t.VERSION=0,t.HEADER_WIDTH_FIELD=10,t.VERSION_FIELD=10,t.OFFSET_SIGN_FIELD=1,t.OFFSET_VAL_FIELD=21,t.CHAR_WIDTH_FIELD=8,t.POINTER_WIDTH_FIELD=8},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function u(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();Object.defineProperty(t,"__esModule",{value:!0});var f=r(4),a=n(f),s=r(5),c=n(s),l=r(2),_=function(){function e(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];u(this,e),this.root=t,this.frozen=!1}return o(e,[{key:"insert",value:function(e){if(this.frozen)throw new SyntaxError("Can't insert into frozen Trie");var t=e.split("").reduce(function(e,t){if(t===l.TERMINAL)throw new TypeError("Illegal string character "+l.TERMINAL);var r=e.hasOwnProperty(t)?e[t]:e[t]={};return r},this.root);return t[l.TERMINAL]=l.TERMINUS,this}},{key:"test",value:function(e){var t=this.root,r=e.split("").every(function(e){return t=t[e]});return!!r&&t.hasOwnProperty(l.TERMINAL)}},{key:"clone",value:function(){return new e(this.toJSON())}},{key:"freeze",value:function(){if(this.frozen)return this;for(var e={},t=this.root,r=[],n=[t];n.length;)t=n.pop(),Object.keys(t).forEach(function(e){if("_"!==e[1]){var i=t[e];r.push({current:i,"char":e,parent:t}),n.push(i)}});for(var i=function(){var t=r.pop(),n=t["char"],i=t.parent,u=t.current;if(e.hasOwnProperty(n)){var o=e[n],f=o.find(function(e){var t=Object.keys(e),r=Object.keys(u);return t.length===r.length&&t.every(function(t){return e[t]===u[t]})});f?i[n]=f:o.push(u)}else e[n]=[u]};r.length;)i();return this.frozen=!0,this}},{key:"encode",value:function(){for(var e=[],t=[this.root],r=new Set,n=Date.now(),u=1/0,o=-(1/0),f=function(){var i=t.shift(),f=Object.keys(i).filter(function(e){return"_"!==e[1]}),a=f.length;i.__visited__=n;var s=i.__idx__=e.length;i.__parents__&&i.__parents__.forEach(function(e){var t=e.offset=s-e.idx;u>t&&(u=t),t>o&&(o=t)}),f.forEach(function(f,s){var c=i[f],l=e.length,_=s===a-1,h={"char":f,idx:l,offset:null,last:_};if(c.__visited__===n){var d=c.__idx__,v=h.offset=d-l;u>v&&(u=v),v>o&&(o=v)}else c.__willVisit__===n?c.__parents__.push(h):(c.__willVisit__=n,c.__parents__=[h]),t.push(c);e.push(h),r.add(f)})};t.length;)f();var s=Array.from(r).filter(function(e){return e!==l.TERMINAL}),_=s.reduce(function(e,t,r){return e[t]=r+1,e},i({},l.TERMINAL,0)),h=(0,a["default"])(s.length)+1,d=o-u,v=(0,a["default"])(d)+1,p=new c["default"];e.forEach(function(e){var t=e["char"],r=e.offset,n=e.last;p.write(_[t],h),p.write(r-u,v),p.write(+n,1)}),p.flush();var E=new c["default"],I=s.join(""),y=Math.ceil((l.HEADER_WIDTH_FIELD+l.VERSION_FIELD+l.OFFSET_SIGN_FIELD+l.OFFSET_VAL_FIELD+l.CHAR_WIDTH_FIELD+l.POINTER_WIDTH_FIELD)/6)+I.length,T=+(0>u);return E.write(y,l.HEADER_WIDTH_FIELD),E.write(l.VERSION,l.VERSION_FIELD),E.write(T,l.OFFSET_SIGN_FIELD),E.write(T?-u:u,l.OFFSET_VAL_FIELD),E.write(h,l.CHAR_WIDTH_FIELD),E.write(v,l.POINTER_WIDTH_FIELD),E.flush(),""+E.getData()+I+p.getData()}},{key:"toJSON",value:function(){var e=JSON.stringify(this.root,function(e,t){return"_"===e[1]?void 0:t});return JSON.parse(e)}}]),e}();t["default"]=_},function(e,t){"use strict";function r(e){for(var t=0;e>>=1;)t++;return t}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=r},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();Object.defineProperty(t,"__esModule",{value:!0});var o=r(4),f=n(o),a=r(1),s=function(){function e(){i(this,e),this.buffer=0,this.pointer=0,this.data=""}return u(e,[{key:"write",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?null:arguments[1],r=this.buffer,n=t||(0,f["default"])(e)+1;if(t&&e>=1<<t)throw new Error("Can't write "+e+" in only "+t+" bits");this.buffer=r<<n|e,this.pointer+=n,this._digest()}},{key:"flush",value:function(){for(var e=this.buffer,t=this.pointer;t&&6>t;)e<<=1,t+=1;this.pointer=t,this.buffer=e,this._digest()}},{key:"getData",value:function(){return this.flush(),this.data}},{key:"_digest",value:function(){for(var e=this.buffer,t=this.pointer,r="";t>=6;){var n=t-6,i=e>>n;e^=i<<n,t=n,r+=a.BASE64_INT_TO_CHAR[i]}this.pointer=t,this.buffer=e,this.data+=r}}]),e}();t["default"]=s}])});