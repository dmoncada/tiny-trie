!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.TinyTrie=t():e.TinyTrie=t()}(this,function(){return function(e){function t(n){if(r[n])return r[n].exports;var i=r[n]={exports:{},id:n,loaded:!1};return e[n].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var r={};return t.m=e,t.c=r,t.p="",t(0)}([function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e){var t=new f["default"];return e.forEach(function(e){return t.insert(e)}),t}function o(e){return i(e).freeze()}Object.defineProperty(t,"__esModule",{value:!0}),t.BinaryString=void 0;var u=r(1);Object.defineProperty(t,"BinaryString",{enumerable:!0,get:function(){return u["default"]}}),t.createSync=i,t.createFrozenSync=o;var a=r(3),f=n(a)},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();Object.defineProperty(t,"__esModule",{value:!0});var u=r(2),a=n(u),f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),s=function(){function e(){i(this,e),this.buffer=0,this.pointer=0,this.data=""}return o(e,[{key:"write",value:function(e){var t=arguments.length<=1||void 0===arguments[1]?null:arguments[1],r=this.buffer,n=t||a["default"](e)+1;if(t&&e>=1<<t)throw new Error("Can't write "+e+" in only "+t+" bits");this.buffer=r<<n|e,this.pointer+=n,this._digest()}},{key:"flush",value:function(){for(var e=this.buffer,t=this.pointer;t&&6>t;)e<<=1,t+=1;this.pointer=t,this.buffer=e,this._digest()}},{key:"getData",value:function(){return this.flush(),this.data}},{key:"_digest",value:function(){for(var e=this.buffer,t=this.pointer,r="";t>=6;){var n=t-6,i=e>>n;e^=i<<n,t=n,r+=f[i]}this.pointer=t,this.buffer=e,this.data+=r}}]),e}();t["default"]=s},function(e,t){"use strict";function r(e){for(var t=0;e>>=1;)t++;return t}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=r},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();Object.defineProperty(t,"__esModule",{value:!0});var u=r(2),a=n(u),f=r(1),s=n(f),c="\x00",l=Object.create(null),h=function(){function e(){var t=arguments.length<=0||void 0===arguments[0]?{}:arguments[0];i(this,e),this.root=t,this.frozen=!1}return o(e,[{key:"insert",value:function(e){if(this.frozen)throw new SyntaxError("Can't insert into frozen Trie");var t=e.split("").reduce(function(e,t){if(t===c)throw new TypeError("Illegal string character "+c);var r=e.hasOwnProperty(t)?e[t]:e[t]={};return r},this.root);return t[c]=l,this}},{key:"test",value:function(e){var t=this.root,r=e.split("").every(function(e){return t=t[e]});return!!r&&t.hasOwnProperty(c)}},{key:"clone",value:function(){return new e(JSON.parse(JSON.stringify(this.root)))}},{key:"freeze",value:function(){if(this.frozen)return this;for(var e={},t=this.root,r=[],n=[t];n.length;)t=n.pop(),Object.keys(t).forEach(function(e){if("_"!==e[1]){var i=t[e];r.push({current:i,"char":e,parent:t}),n.push(i)}});for(var i=function(){var t=r.pop(),n=t["char"],i=t.parent,o=t.current;if(e.hasOwnProperty(n)){var u=e[n],a=u.find(function(e){var t=Object.keys(e),r=Object.keys(o);return t.length===r.length&&t.every(function(t){return e[t]===o[t]})});a?i[n]=a:u.push(o)}else e[n]=[o]};r.length;)i();return this.frozen=!0,this}},{key:"encode",value:function(){for(var e=[],t=[this.root],r=new Set,n=Date.now(),i=1/0,o=-(1/0),u=function(){var u=t.shift(),a=Object.keys(u).filter(function(e){return"_"!==e[1]}),f=a.length;u.__visited__=n;var s=u.__idx__=e.length;u.__parents__&&u.__parents__.forEach(function(e){var t=e.offset=s-e.idx;i>t&&(i=t),t>o&&(o=t)}),a.forEach(function(a,s){var c=u[a],l=e.length,h=s===f-1,d={"char":a,idx:l,offset:null,last:h};if(c.__visited__===n){var v=c.__idx__,p=d.offset=v-l;i>p&&(i=p),p>o&&(o=p)}else c.__willVisit__===n?c.__parents__.push(d):(c.__willVisit__=n,c.__parents__=[d]),t.push(c);e.push(d),r.add(a)})};t.length;)u();var f=Array.from(r),c=f.reduce(function(e,t,r){return e[t]=r,e},{}),l=a["default"](f.length-1)+1,h=o-i,d=a["default"](h)+1,v=new s["default"];return e.forEach(function(e){var t=e["char"],r=e.offset,n=e.last;v.write(c[t],l),v.write(r-i,d),v.write(+n,1)}),v.flush(),{table:f.join(""),offset:i,dimensions:[l,d],data:v.getData()}}},{key:"toJSON",value:function(){return JSON.parse(JSON.stringify(this.root))}}]),e}();t["default"]=h}])});